(function(){var a=function(b,c){return function(){return b.apply(c,arguments)}};this.IndexViewController=(function(){b.prototype.API="http://localhost:54870/";function b(){this.SigninAuth=a(this.SigninAuth,this);this.initialAuth=a(this.initialAuth,this);this.hideAll();CookieJar.xread();$('#signinForm input[type="submit"]').click((function(c){return function(d){d.preventDefault();return c.SignIn()}})(this));if($("#XID").val()!==""){this.initialAuth()}else{window.location.replace("register.html")}}b.prototype.initialAuth=function(){if($("#XID").val()===""){return}this.showConnecting();return $.ajax({type:"GET",url:this.API+"client/initial/"+$("#XID").val(),success:(function(c){return function(d,f,e){return c.gotInit(d)}})(this)})};b.prototype.SigninAuth=function(){var c;c=$("form#signinForm").serialize();if($("#XID").val()===""){return}this.showConnecting();return $.ajax({type:"POST",url:this.API+"client/authenticate",data:c,success:(function(d){return function(e,g,f){return d.gotLogin(e)}})(this)})};b.prototype.gotLogin=function(c){CookieJar.xwrite(c.Token,c.Auth);return window.location.replace("tx.html")};b.prototype.gotInit=function(e){var c;this.hideAll();c=e.Token;CookieJar.write("xid",c);if(c==="0"){window.location.replace("register.html");return}if(c==="1"){$("input#username").val("Demonstration").attr("readonly","readonly");$("input#password").val("Demonstration").attr("readonly","readonly")}if(c==="1"||c.length>12){$("#XID").val(c);return $("div#Signin").fadeIn()}};b.prototype.hideAll=function(){$("div#connecting").hide();return $("div#Signin").hide()};b.prototype.showConnecting=function(){this.hideAll();return $("div#connecting").fadeIn()};b.prototype.SignIn=function(){return this.SigninAuth()};return b})();$(function(){return new IndexViewController})}).call(this);