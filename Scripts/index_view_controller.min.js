(function(){var a=function(b,c){return function(){return b.apply(c,arguments)}};this.IndexViewController=(function(){b.prototype.API="http://localhost:54870/";b.prototype.XID=null;function b(){this.SigninAuth=a(this.SigninAuth,this);this.initialAuth=a(this.initialAuth,this);this.hideAll();$('#signinForm input[type="submit"]').click((function(c){return function(d){d.preventDefault();return c.SignIn()}})(this));this.XID=CookieJar.read("xid");if((this.XID!=null)&&this.XID!==""){this.initialAuth()}else{window.location.replace("register.html")}}b.prototype.initialAuth=function(){if((this.XID==null)||this.XID===""){return}this.showConnecting();return $.ajax({type:"GET",url:this.API+"api/initial/"+this.XID,success:(function(c){return function(d,f,e){return c.gotInit(d)}})(this)})};b.prototype.SigninAuth=function(){var c;c=$("form#signinForm").serialize();if((this.XID==null)||this.XID===""){return}this.showConnecting();return $.ajax({type:"POST",url:this.API+"client/authenticate",data:c,success:(function(d){return function(e,g,f){return d.gotLogin(e)}})(this)})};b.prototype.gotLogin=function(c){$("#keyhole").html(c);this.hideAll();$("#TXCenter").fadeIn();return $("#ActTel").focus()};b.prototype.gotInit=function(e){var c;$("#keyhole").html(e);this.hideAll();c=$.parseJSON(e);if(c.Key===0){window.location.replace("register.html");return}if(c.Key===1){$("input#username").val("Demonstration").attr("readonly","readonly");$("input#password").val("Demonstration").attr("readonly","readonly")}if(c.Key===1||c.Key.length>12){$("#XID").val(c.Key);return $("div#Signin").fadeIn()}};b.prototype.hideAll=function(){$("div#connecting").hide();$("div#Signin").hide();return $("div#TXCenter").hide()};b.prototype.showConnecting=function(){this.hideAll();return $("div#connecting").fadeIn()};b.prototype.SignIn=function(){return this.SigninAuth()};return b})();$(function(){return new IndexViewController})}).call(this);